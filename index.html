<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kill Team Game Tracker</title>
<style>
/* ========================================
    BASE STYLES & LAYOUT
    ========================================
*/
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
    color: #e0e0e0;
    min-height: 100vh;
    padding: 20px;
}
.container {
    max-width: 1000px;
    margin: 0 auto;
}
h1 {
    text-align: center;
    color: #ff6b35;
    margin-bottom: 30px;
    font-size: 2.5rem;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
    font-weight: bold;
    letter-spacing: 2px;
}
/* ========================================
    FILTER & UI CONTROLS
    ========================================
*/
.filters {
    background: linear-gradient(135deg, #2a2a2a 0%, #3a3a3a 100%);
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 30px;
    border: 2px solid #444;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    transition: opacity 0.5s ease, transform 0.5s ease;
}
.filter-section {
    margin-bottom: 20px;
}
.filter-section:last-child {
    margin-bottom: 0;
}
.filter-section h3 {
    color: #ff6b35;
    margin-bottom: 10px;
    font-size: 1.1rem;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 1px;
}
.filter-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}
.filter-btn {
    background: #444;
    border: 2px solid #666;
    color: #e0e0e0;
    padding: 8px 16px;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.9rem;
    font-weight: bold;
}
.filter-btn:hover {
    background: #555;
    border-color: #ff6b35;
    transform: translateY(-2px);
}
.filter-btn.active {
    background: #ff6b35;
    color: #1a1a1a;
    border-color: #ff6b35;
    font-weight: bold;
}
/* Kill Grade Table Styles */
.kill-grade-table {
    width: 100%;
    margin-top: 15px;
    border-collapse: collapse;
    font-size: 0.85rem;
}
.kill-grade-table th, .kill-grade-table td {
    border: 1px solid #555;
    padding: 6px;
    text-align: center;
}
.kill-grade-table th {
    background-color: #ff6b35;
    color: #1a1a1a;
    font-weight: bold;
}
.kill-grade-table tbody td:first-child {
    font-weight: bold;
    background-color: #3e3e3e;
}
.lock-section {
    background: linear-gradient(135deg, #2a2a2a 0%, #3a3a3a 100%);
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 30px;
    text-align: center;
    border: 2px solid #444;
    transition: opacity 0.5s ease, transform 0.5s ease;
}
.op-select-section {
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    justify-content: center; /* Centers the select element and label */
    gap: 10px;
}
#op-count-select {
    font-size: 1.2rem;
    padding: 8px 12px;
    width: 100px; /* Adjust this value as needed */
    border-radius: 5px;
    background: #444;
    color: #e0e0e0;
    border: 2px solid #666;
    cursor: pointer;
    text-align: center;
}
.primary-selection {
    margin-bottom: 15px;
    text-align: center; /* This centers the h4 and the button div */
}
.primary-buttons {
    display: flex; /* This makes the buttons line up horizontally */
    flex-wrap: wrap;
    justify-content: center; /* This centers the buttons within their own line */
}
.lock-btn {
    background: #ff6b35;
    color: #1a1a1a;
    border: none;
    padding: 15px 30px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1.2rem;
    font-weight: bold;
    transition: all 0.3s ease;
    margin: 10px;
    text-transform: uppercase;
    letter-spacing: 1px;
}
.lock-btn:hover {
    background: #e55a2b;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(255,107,53,0.3);
}
.lock-btn:disabled {
    background: #666;
    color: #aaa;
    cursor: not-allowed;
    transform: none;
}
/* ========================================
    CARD GRID & INDIVIDUAL CARD STYLES
    ========================================
*/
.cards-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
    transition: opacity 0.5s ease, transform 0.5s ease;
}
.card {
    background: linear-gradient(135deg, #2a2a2a 0%, #3a3a3a 100%);
    border-radius: 10px;
    padding: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 2px solid #444;
    position: relative;
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}
.card.hidden { display: none; }
.card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    opacity: 0;
    transition: opacity 0.3s ease;
}
.card.recon::before { background: #4a90e2; }
.card.seek-destroy::before { background: #d0021b; }
.card.security::before { background: #7ed321; }
.card.infiltration::before { background: #9013fe; }
.card.kill-op::before { background: #f5a623; }
.card.crit-op::before { background: #36899a; }
.card:hover {
    transform: translateY(-5px);
    border-color: #ff6b35;
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
}
.card:hover::before { opacity: 1; }
.card.selected {
    border-color: #ff6b35;
    background: linear-gradient(135deg, #3a2a1a 0%, #4a3a2a 100%);
    transform: scale(1.02);
}
.card.selected::before { opacity: 1; }
.card-archetype {
    font-size: 0.8rem;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 8px;
    padding: 4px 8px;
    border-radius: 3px;
    display: inline-block;
}
.card-archetype.recon { background: #4a90e2; color: white; }
.card-archetype.seek-destroy { background: #d0021b; color: white; }
.card-archetype.security { background: #7ed321; color: white; }
.card-archetype.infiltration { background: #9013fe; color: white; }
.card-archetype.crit-op { background: #36899a; color: white; }
.card-name {
    font-size: 1.2rem;
    font-weight: bold;
    margin-bottom: 12px;
    color: #ffffff;
}
.card-rules {
    font-size: 0.9rem;
    line-height: 1.4;
    color: #cccccc;
}
.card-rules strong {
    color: #ff6b35;
}
.footer-note {
    text-align: center;
    font-size: 0.9rem;
    color: #aaa;
    margin-top: 30px;
}
/* ========================================
    GAME STATUS & COUNTERS
    ========================================
*/
.game-status {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 20px;
    margin-bottom: 30px;
}
.status-card {
    background: linear-gradient(135deg, #2a2a2a 0%, #3a3a3a 100%);
    border-radius: 10px;
    padding: 20px;
    text-align: center;
    border: 2px solid #444;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
}
.status-card .rules strong {
    color: #ff6b35; /* Your cool orange color */
}
.status-card.selected-status { border-color: #ff6b35; }
.status-card.locked { border-color: #ff6b35; }
.status-card h3 {
    color: #ff6b35;
    font-size: 1rem;
    margin-bottom: 10px;
    text-transform: uppercase;
    letter-spacing: 1px;
}
.status-card .selection {
    font-size: 1.1rem;
    font-weight: bold;
    margin-bottom: 5px;
    color: #fff;
}
.status-card .rules {
    font-size: 0.9rem;
    line-height: 1.5;
    color: #cccccc;
    margin-top: 10px;
    display: none;
    text-align: left;
}
.top-counters {
    display: flex;
    justify-content: center;
    gap: 30px;
    margin-bottom: 30px;
}
.counter-group {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin-top: 15px;
}
.counter-box {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}
.counter-label {
    font-size: 0.9rem;
    color: #ff6b35;
    font-weight: bold;
    margin-bottom: 5px;
}
.counter-display {
    font-size: 1.5rem;
    font-weight: bold;
    color: #fff;
    background: #444;
    padding: 5px 15px;
    border-radius: 5px;
}
.counter-btn {
    background: #ff6b35;
    color: #1a1a1a;
    border: none;
    padding: 5px 10px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 1.5rem;
    line-height: 1;
    font-weight: bold;
    transition: all 0.2s ease;
    margin: 2px;
}
.counter-btn:hover {
    background: #e55a2b;
    transform: translateY(-1px);
}
.counter-btn:active {
    background: #cc4d20;
    transform: translateY(0);
}
.op-counter-box {
    display: flex;
    flex-direction: column;
    align-items: center;
}
.op-counter-group {
    display: flex;
    flex-direction: row; /* Changed to row for horizontal layout */
    justify-content: center;
    align-items: center; /* Aligns items vertically in the row */
    gap: 10px;
    margin-top: 10px;
    border-top: 1px solid #444;
    padding-top: 10px;
}
.op-counter-btn {
    background: #ff6b35;
    color: #1a1a1a;
    border: none;
    padding: 5px 15px;
    font-size: 2rem;
    cursor: pointer;
    border-radius: 5px;
    transition: all 0.2s ease;
}
.op-counter-count {
    font-size: 2rem;
    font-weight: bold;
    color: #fff;
}
/* ========================================
    LOCKED STATE STYLES
    ========================================
*/
.container.game-locked .filters,
.container.game-locked .cards-grid,
.container.game-locked .op-select-section,
.container.game-locked .selection-prompt,
.container.game-locked .primary-selection,
.container.game-locked #lockBtn {
    opacity: 0;
    transform: scale(0.95);
    pointer-events: none;
    display: none;
}
.container.game-locked .game-timer { display: block; }
.container.game-locked .game-status { grid-template-columns: 1fr; }
.container.game-locked .status-card .rules { display: block; }
.primary-indicator { color: #fce83a !important; }
.container.game-locked .status-card:not(.locked) { display: none; }
/* ========================================
    RESPONSIVE DESIGN
    ========================================
*/
@media (max-width: 768px) {
    body { padding: 10px; }
    h1 { font-size: 2rem; margin-bottom: 20px; }
    .game-status { grid-template-columns: 1fr; }
    .filters { padding: 15px; }
    .cards-grid { grid-template-columns: 1fr; }
}
@media (max-width: 1080px) {
    .filter-btn { font-size: 0.8rem; padding: 6px 12px; }
    .card { padding: 15px; }
    .card-name { font-size: 1.1rem; }
    .lock-btn { font-size: 1rem; padding: 12px 20px; }
    .top-counters {gap: 15px; } /* Reduce the space between the counters */
    .counter-group {gap: 5px;} /* Reduce the space between the buttons and the number */
    .counter-btn {padding: 3px 6px; font-size: 1.2rem;} /* Make the buttons slightly smaller & Reduce the button icon size */
}
.counter-display {
    font-size: 1.2rem; /* Reduce the number size */
    padding: 3px 10px; /* Adjust padding to match the smaller size */
}
}
</style>
</head>
<body>

<div class="container" id="mainContainer">
    <h1>KILL TEAM GAME TRACKER</h1>

    <div class="top-counters" style="display: none;">
        <div class="counter-box">
            <div class="counter-label">TP</div>
            <div class="counter-group">
                <button class="counter-btn" onclick="updateCounter('tp', -1)">-</button>
                <div class="counter-display" id="tpCounter">0</div>
                <button class="counter-btn" onclick="updateCounter('tp', 1)">+</button>
            </div>
        </div>
        <div class="counter-box">
            <div class="counter-label">CP</div>
            <div class="counter-group">
                <button class="counter-btn" onclick="updateCounter('cp', -1)">-</button>
                <div class="counter-display" id="cpCounter">0</div>
                <button class="counter-btn" onclick="updateCounter('cp', 1)">+</button>
            </div>
        </div>
        <div class="counter-box">
            <div class="counter-label">VP</div>
            <div class="counter-group" id="vpCounterGroup">
                <div class="counter-display" id="vpCounter">0</div>
                <div id="vpAdj">(<span id="vpAdjValue">0</span> adjusted)</div>
            </div>
        </div>
    </div>
    
    <div class="game-status">
        <div class="status-card selected-status locked" id="killOpStatus">
            <h3>Kill Op</h3>
            <div class="selection" id="killOpSelection">Always Active</div>
            <div class="primary-indicator" id="killPrimaryIndicator" style="font-size: 0.8rem; color: #f5a623; font-weight: bold; opacity: 0;">★ PRIMARY</div>
            <div class="rules" id="killOpRules"></div>
            <div class="op-counter-box" style="display: none;">
                <div class="op-counter-group">
                    <button class="op-counter-btn" onclick="updateOpCounter('kill', -1)">▼</button>
                    <div class="op-counter-count" id="killOpCount">0</div>
                    <button class="op-counter-btn" onclick="updateOpCounter('kill', 1)">▲</button>
                </div>
            </div>
        </div>
        <div class="status-card" id="critOpStatus">
            <h3>Crit Op</h3>
            <div class="selection" id="critOpSelection">Not Selected</div>
            <div class="primary-indicator" id="critPrimaryIndicator" style="font-size: 0.8rem; color: #36899a; font-weight: bold; opacity: 0;">★ PRIMARY</div>
            <div class="rules" id="critOpRules"></div>
            <div class="op-counter-box" style="display: none;">
                <div class="op-counter-group">
                    <button class="op-counter-btn" onclick="updateOpCounter('crit', -1)">▼</button>
                    <div class="op-counter-count" id="critOpCount">0</div>
                    <button class="op-counter-btn" onclick="updateOpCounter('crit', 1)">▲</button>
                </div>
            </div>
        </div>
        <div class="status-card" id="tacOpStatus">
            <h3>Tac Op</h3>
            <div class="selection" id="tacOpSelection">Not Selected</div>
            <div class="primary-indicator" id="tacPrimaryIndicator" style="font-size: 0.8rem; color: #4a90e2; font-weight: bold; opacity: 0;">★ PRIMARY</div>
            <div class="rules" id="tacOpRules"></div>
            <div class="op-counter-box" style="display: none;">
                <div class="op-counter-group">
                    <button class="op-counter-btn" onclick="updateOpCounter('tac', -1)">▼</button>
                    <div class="op-counter-count" id="tacOpCount">0</div>
                    <button class="op-counter-btn" onclick="updateOpCounter('tac', 1)">▲</button>
                </div>
            </div>
        </div>
    </div>

    <div class="lock-section">
        <div class="game-timer" id="gameTimer"></div>
        
        <div class="op-select-section">
            <label for="op-count-select" style="color: #ff6b35; font-weight: bold;">Starting Enemy Operatives:</label>
            <select id="op-count-select"></select>
        </div>
        <div class="primary-selection" style="margin-bottom: 15px;">
    <h4 style="color: #ff6b35; margin-bottom: 10px;">Select Primary Operation:</h4>
    <div class="primary-buttons">
        <button class="lock-btn" id="primaryKillBtn" onclick="selectPrimary('kill')" disabled style="background: #f5a623; margin: 5px;">Kill Op</button>
        <button class="lock-btn" id="primaryCritBtn" onclick="selectPrimary('crit')" disabled style="background: #36899a; margin: 5px;">Crit Op</button>
        <button class="lock-btn" id="primaryTacBtn" onclick="selectPrimary('tac')" disabled style="background: #4a90e2; margin: 5px;">Tac Op</button>
    </div>
</div>
        <button class="lock-btn" id="lockBtn" onclick="lockSelections()" disabled>Lock In & Start The Game</button>
        <p class="selection-prompt" style="margin-bottom: 5px; color: #5a5a5a;">"LOCK IN" time will be shown on the next page to prevent undisclosed altering of choices.</p>
        <p class="selection-prompt" style="margin-bottom: 0px; color: #cccccc;">Select the number of enemies on your opponents team. Select the Crit Op. Select your Tac Op.<br>Choose an Op to be the "Primary". Lock In & Start The Game.</p>
    </div>

    <div class="filters">
        <div class="filter-section">
            <h3>Team Archetypes</h3>
            <div class="filter-buttons" id="archetypeFilters">
                <button class="filter-btn" data-filter="Recon">Recon</button>
                <button class="filter-btn" data-filter="Seek & Destroy">Seek & Destroy</button>
                <button class="filter-btn" data-filter="Security">Security</button>
                <button class="filter-btn" data-filter="Infiltration">Infiltration</button>
            </div>
        </div>
    </div>

    <div class="cards-grid" id="cardsGrid"></div>

    <p class="footer-note">Refresh the page to reset all selections and start a new game.</p>
</div>

<script>
    const killGradeData = {
        '5': [1, 2, 3, 4, 5],
        '6': [1, 2, 4, 5, 6],
        '7': [1, 3, 4, 6, 7],
        '8': [2, 3, 5, 6, 8],
        '9': [2, 4, 5, 7, 9],
        '10': [2, 4, 6, 8, 10],
        '11': [2, 4, 7, 9, 11],
        '12': [2, 5, 7, 10, 12],
        '13': [3, 5, 8, 10, 13],
        '14': [3, 6, 8, 11, 14]
    };
    const critOps = [
  {
    "archetype": "Crit Op",
    "name": "Secure",
    "rules": "<strong>MISSION ACTION: SECURE (1AP)</strong><br><span style=\"color: green;\">\u25b6</span> Select one objective marker under the active operative’s control. That marker counts as secured by your kill team until it is secured by the opponent.<br><span style=\"color: red;\"><span style=\"color: red;\">\u25FC</span></span> This action cannot be used in the first turning point, or if the operative is within control range of an enemy.<br><strong>VICTORY POINTS:</strong><br>At the end of each turning point after the first:<br>\u25CF If any objective markers are secured by your kill team, you gain 1VP.<br>\u25CF If your kill team has secured more objective markers than the opponent’s, you gain 1 additional VP."
  },
  {
    "archetype": "Crit Op",
    "name": "Loot",
    "rules": "<strong>MISSION ACTION: LOOT (1AP)</strong><br><span style=\"color: green;\">\u25b6</span> Choose one objective marker under the active operative’s control. That marker is considered looted.<br><span style=\"color: red;\"><span style=\"color: red;\">\u25FC</span></span> This action cannot be used in the first turning point, while within control range of an enemy, or if that marker has already been looted this turning point.<br><strong>VICTORY POINTS:</strong><br>Each time a friendly operative performs LOOT, you score 1VP (to a limit of 2VP per turning point)."
  },
  {
    "archetype": "Crit Op",
    "name": "Transmission",
    "rules": "<strong>MISSION ACTION: INITIATE TRANSMISSION (1AP)</strong><br><span style=\"color: green;\">\u25b6</span> Select one objective marker under the active operative’s control. That marker becomes transmitting until the start of the next turning point.<br><span style=\"color: red;\"><span style=\"color: red;\">\u25FC</span></span> This action cannot be performed in the first turning point or if within control range of an enemy.<br><strong>VICTORY POINTS:</strong><br>At the end of each turning point after the first:<br>\u25CF If your operatives control at least one transmitting marker, you score 1VP.<br>\u25CF If your operatives control more transmitting markers than the enemy, you score 1 additional VP."
  },
  {
    "archetype": "Crit Op",
    "name": "Upload",
    "rules": "<strong>MISSION ACTION: UPLOAD (1AP)</strong><br><span style=\"color: green;\">\u25b6</span> Remove all opponent Upload points from one objective marker under the active operative’s control.<br><span style=\"color: green;\">\u25b6</span> Then, add one of your Upload points to that marker (unless it already gained one of your Upload points this turning point).<br><span style=\"color: red;\"><span style=\"color: red;\">\u25FC</span></span> This action cannot be taken during the first turning point or while within control range of an enemy.<br><strong>VICTORY POINTS:</strong><br>At the end of each turning point after the first, you can score 1VP for each marker that has one or more of your Upload points. You may only ever score from a given marker once per battle."
  },
  {
    "archetype": "Crit Op",
    "name": "Compile Intel",
    "rules": "<strong>MISSION ACTION: COMPILE INTEL (1AP)</strong><br><span style=\"color: green;\">\u25b6</span> Select one objective marker under the active operative’s control. That marker gains 1 Intel point.<br><span style=\"color: red;\"><span style=\"color: red;\">\u25FC</span></span> This action cannot be performed in the first turning point, if within control range of an enemy, or if the marker already gained an Intel point this turning point.<br><strong>ADDITIONAL RULES</strong><br>From the second turning point onward, a PICK UP MARKER action can be used on a marker with at least 1 Intel point. Once done, that marker cannot gain additional Intel points.<br><strong>VICTORY POINTS:</strong><br>At the end of the fourth turning point, you score VP equal to the Intel points on each marker you control."
  },
  {
    "archetype": "Crit Op",
    "name": "Extraction",
    "rules": "<strong>MISSION ACTION: SEARCH (1AP)</strong><br><span style=\"color: green;\">\u25b6</span> Select one objective marker under the active operative’s control. That marker is searched. If it is the last unsolved marker, it becomes the extraction marker.<br><span style=\"color: red;\"><span style=\"color: red;\">\u25FC</span></span> This action cannot be performed in the first turning point, within control range of an enemy, or on a marker that has already been searched.<br><strong>ADDITIONAL RULES</strong><br>A DROP OFF MARKER action may only be performed on the extraction marker.<br><strong>VICTORY POINTS:</strong><br>Each time a friendly operative uses SEARCH, you gain 1VP if it is the first or third marker searched, or 2VP if it is the second.<br>At the end of each turning point after the first, if your operatives control the extraction marker, you score 1VP (or 2VP if it is the fourth turning point)."
  },
  {
    "archetype": "Crit Op",
    "name": "Sabotage",
    "rules": "<strong>MISSION ACTION: SABOTAGE (1AP)</strong><br><span style=\"color: green;\">\u25b6</span> If the active operative controls an objective marker wholly within your opponent’s territory, mark it as sabotaged.<br><span style=\"color: red;\"><span style=\"color: red;\">\u25FC</span></span> This action cannot be used in the first turning point, while within control range of an enemy, or if the marker was already sabotaged this turning point.<br><strong>VICTORY POINTS:</strong><br>Each time a friendly operative uses SABOTAGE, you gain 1VP.<br>At the end of each turning point after the first, you gain 1VP for each of the following held by your operatives:<br>\u25CF The marker wholly inside your territory (unless sabotaged this turning point).<br>\u25CF The centerline marker.<br>You may score up to 2VP per turning point from this operation."
  },
  {
    "archetype": "Crit Op",
    "name": "Power Surge",
    "rules": "<strong>MISSION ACTION: REROUTE POWER (1AP)</strong><br><span style=\"color: green;\">\u25b6</span> Select one surged marker under the active operative’s control. That marker is rerouted.<br><span style=\"color: red;\"><span style=\"color: red;\">\u25FC</span></span> This action cannot be performed in the first turning point, while within control range of an enemy, or if the marker was already rerouted this turning point.<br><strong>ADDITIONAL RULES</strong><br>At the start of each turning point after the first, as a Strategic Gambit, players alternate choosing one objective marker to surge (not one already surged). The player without initiative selects first.<br><strong>VICTORY POINTS:</strong><br>Whenever a friendly operative reroutes power, you score 1VP.<br>At the end of each turning point after the first, if your operatives control the surged marker, you score 1VP. If your operatives hold more markers than the opponent, score 1 additional VP.<br>Maximum 2VP can be scored from this operation per turning point."
  },
  {
    "archetype": "Crit Op",
    "name": "Coordinates",
    "rules": "<strong>MISSION ACTION: INPUT COORDINATES (1AP)</strong><br><span style=\"color: green;\">\u25b6</span> Select one objective marker under the active operative’s control. Add one of your Objective points to it (use dice as tokens).<br><span style=\"color: red;\"><span style=\"color: red;\">\u25FC</span></span> This action cannot be taken in the first turning point, while within control range of an enemy, or if the marker already gained one of your Objective points this turning point.<br><strong>VICTORY POINTS:</strong><br>At the end of the fourth turning point:<br>\u25CF Each marker with at least one of your Objective points scores you 1VP, or 2VP if wholly in enemy territory.<br>\u25CF Each marker with more of your Objective points than your opponent’s earns you 1VP."
  }
];


        const tacOps = [
  {
    "archetype": "Recon",
    "name": "Confirm Kill",
    "rules": "<strong>REVEAL:</strong> The first time an enemy operative is incapacitated.<br><strong>ADDITIONAL RULES:</strong><br>Each time an enemy operative is incapacitated, before it is removed from the killzone, place one of your Confirm Kill mission markers within its control range.<br>At the end of each turning point after the first, if a friendly operative controls one of these markers, with no enemy operatives contesting it and none within Engagement Range of that friendly operative, score 1VP. If the enemy operative had 14 or more Wounds, instead score 2VP.<br><strong>VICTORY POINTS:</strong><br>A maximum of 2VP can be scored from this tac op per turning point."
  },
  {
    "archetype": "Recon",
    "name": "Recover Items",
    "rules": "<strong>REVEAL:</strong> During the Set Up Operatives step, before equipment is placed.<br><strong>ADDITIONAL RULES:</strong><br>After revealing, your opponent sets one of your item mission markers on the centre line, within 2\" of your territory. You then set another at least 6\" from your territory. Markers must be more than 2\" from any other marker. From the second turning point onwards, your operatives may use the Pick Up Marker action on your item mission markers.<br><strong>VICTORY POINTS:</strong><br>At the end of the fourth turning point, score 2VP for each of your item mission markers that friendly operatives control without enemy control."
  },
  {
    "archetype": "Recon",
    "name": "Plant Beacons",
    "rules": "<strong>REVEAL:</strong> The first time a friendly operative performs the Plant Beacon action.<br><strong>MISSION ACTION – PLANT BEACON (1AP):</strong><br><span style=\"color: green;\">\u25b6</span> Place one of your Beacon mission markers:<br>\u2022 Within the active operative’s control range.<br>\u2022 More than 6\" from your drop zone.<br>\u2022 More than 6\" away from your other Beacon mission markers. In a killzone that uses the close quarters rules (e.g. Killzone: Gallowdark), ignore Wall terrain when measuring this distance.<br>\u2022 With no part of it underneath Vantage terrain.<br><span style=\"color: red;\"><span style=\"color: red;\">\u25FC</span></span> An operative cannot perform this action during the first turning point, while within control range of an enemy operative, or during an activation in which it was set up.<br><strong>VICTORY POINTS:</strong><br>Once per turning point after the first, whenever one of your Beacon mission markers is placed wholly within your territory, you score 1VP.<br>Once per turning point after the first, whenever one of your Beacon mission markers is placed wholly within your opponent's territory, you score 1VP."
  },
  {
    "archetype": "Seek & Destroy",
    "name": "Overrun",
    "rules": "<strong>REVEAL:</strong> When you first score VP from this tac op.<br><strong>VICTORY POINTS:</strong><br>Once per turning point after the first, if a friendly operative incapacitates an enemy operative while wholly within enemy territory, score 1VP.<br>At the end of each turning point after the first, if the combined APL of friendly operatives that achieved the above condition (whether VP was scored or not) is 6 or more and those operatives remain wholly within enemy territory, score 1VP."
  },
  {
    "archetype": "Seek & Destroy",
    "name": "Storm Objectives",
    "rules": "<strong>REVEAL:</strong> When you first score VP from this tac op.<br><strong>ADDITIONAL RULES:</strong><br>After each friendly operative’s activation, if it controls an objective marker wholly within enemy territory that no enemy operatives control, that marker is considered stormed by your operatives.<br><strong>VICTORY POINTS:</strong><br>Once per turning point after the first, if an objective marker was stormed by your operatives that turn, score 1VP.<br>At the end of each turning point after the first, if your operatives still control a stormed objective marker, score 1VP."
  },
  {
    "archetype": "Seek & Destroy",
    "name": "Champion",
    "rules": "<strong>REVEAL:</strong> When you nominate your first champion.<br><strong>ADDITIONAL RULES:</strong><br>As a STRATEGIC GAMBIT in each turning point after the first, you may select one friendly operative to act as your champion for that turning point.<br><strong>VICTORY POINTS:</strong><br>Each turning point after the first, if your champion incapacitates an enemy operative, score 1VP. If the enemy had 12 or more Wounds, score 2VP instead. Maximum 2VP per turning point."
  },
  {
    "archetype": "Security",
    "name": "Contain",
    "rules": "<strong>REVEAL:</strong> When you first score VP from this tac op.<br><strong>VICTORY POINTS:</strong><br>At the end of each turning point after the first:<br>\u2022 If no enemy operatives are wholly inside your territory, score 1VP.<br>\u2022 If there are no enemy operatives wholly within 6\" of your drop zone, score 1VP."
  },
  {
    "archetype": "Security",
    "name": "Take Ground",
    "rules": "<strong>REVEAL:</strong> When you first score VP from this tac op.<br><strong>VICTORY POINTS:</strong><br>At the end of each turning point after the first:<br>\u2022 In Killzone: Volkus, if your operatives control a Stronghold terrain piece wholly inside enemy territory, score 1VP.<br>\u2022 In Killzone: Gallowdark, for each access point wholly inside enemy territory or on the centre line that your operatives control, score 1VP.<br>\u2022 In other killzones, for each Heavy terrain feature inside enemy territory controlled by your operatives, score 1VP.<br>You may score a maximum of 2VP per turning point from this tac op.<br><strong>ADDITIONAL RULES:</strong><br>A Stronghold terrain piece is contested if an operative is wholly within it. Other terrain features are contested by operatives within their control range, or while under Vantage terrain. Operatives control terrain when the total APL of contesting friendlies is higher than that of contesting enemies."
  },
  {
    "archetype": "Security",
    "name": "Secure Centre",
    "rules": "<strong>REVEAL:</strong> When you first score VP from this tac op.<br><strong>VICTORY POINTS:</strong><br>At the end of each turning point after the first:<br>\u2022 If your operatives control the objective marker within 3\" of the killzone centre and no enemy operatives do, score 1VP.<br>\u2022 If the total APL of your operatives within 3\" of that marker (not within Engagement Range of enemies) is greater than that of enemy operatives, score 1VP."
  },
  {
    "archetype": "Infiltration",
    "name": "Surveillance",
    "rules": "<strong>REVEAL:</strong> The first time a friendly operative carries out the Surveillance action.<br><strong>MISSION ACTION – SURVEILLANCE (1AP):</strong><br><span style=\"color: green;\">\u25b6</span> The operative gathers surveillance.<br><span style=\"color: red;\"><span style=\"color: red;\">\u25FC</span></span> Cannot be used while the operative has an Engage order. The operative must be wholly inside enemy territory and target an eligible enemy operative.<br><span style=\"color: red;\"><span style=\"color: red;\">\u25FC</span></span> Cannot be performed during the first turning point or within control range of an enemy operative.<br><strong>VICTORY POINTS:</strong><br>Once per turning point after the first, if a friendly operative performs Surveillance, score 1VP.<br>At the end of each turning point after the first, if an operative that performed Surveillance this turn remains in the killzone with a Conceal order, score 1VP."
  },
  {
    "archetype": "Infiltration",
    "name": "Implant",
    "rules": "<strong>REVEAL:</strong> When you first score VP from this tac op.<br><strong>ADDITIONAL RULES:</strong><br>When a friendly operative is fighting, instead of resolving one attack dice, you may implant the enemy operative. When a friendly operative shoots at an enemy within 6\", you may implant instead of shooting, inflicting 1 mortal wound instead of normal damage. Each operative may only be implanted once and cannot be implanted during the activation in which they are incapacitated.<br><strong>VICTORY POINTS:</strong><br>Once per turning point after the first, if an enemy operative is implanted, score 1VP.<br>At the end of each turning point after the first, if any implanted enemy operatives remain in the killzone, score 1VP."
  },
  {
    "archetype": "Infiltration",
    "name": "Wiretap",
    "rules": "<strong>REVEAL:</strong> The first time a friendly operative carries out the Wiretap action.<br><strong>MISSION ACTION – WIRETAP (1AP):</strong><br><span style=\"color: green;\">\u25b6</span> Place one of your Wiretap mission markers within the operative’s control range. It becomes active in the Ready step of the following Strategy phase.<br><span style=\"color: red;\"><span style=\"color: red;\">\u25FC</span></span> Cannot be used in the first turning point, within enemy control range, or if another of your Wiretap markers was placed earlier that turning point.<br><strong>VICTORY POINTS:</strong><br>Once per turning point after the first, if an enemy operative begins or ends an activation within 2\" of your Wiretap marker, score 1VP.<br>At the end of each turning point after the first, if any Wiretap mission markers with an Engage order are within 2\" of your Wiretap marker, score 1VP."
  }
];
    const allCards = [...critOps, ...tacOps];
    let selectedCritOp = null, selectedTacOp = null, primaryOp = null, gameStartTime = null;
    let isLocked = false;
    let startingEnemyOperatives = 5;
    let activeFilters = { archetypes: [] };
    const opCounters = { kill: 0, crit: 0, tac: 0 };
    const gameCounters = { tp: 0, cp: 0 };
    function init() { populateOpSelector(); setupEventListeners(); renderCards(); updateUI(); }
    function populateOpSelector() {
        const select = document.getElementById('op-count-select');
        for (let i = 5; i <= 14; i++) {
            const option = document.createElement('option');
            option.value = i;
            option.textContent = i;
            select.appendChild(option);
        }
    }
    function setupEventListeners() {
        document.getElementById('op-count-select').addEventListener('change', (e) => { startingEnemyOperatives = parseInt(e.target.value, 10); });
        document.querySelectorAll('#archetypeFilters .filter-btn').forEach(btn => btn.addEventListener('click', () => handleArchetypeFilter(btn)));
    }
    function handleArchetypeFilter(clickedBtn) {
        const filter = clickedBtn.dataset.filter;
        clickedBtn.classList.toggle('active');
        if (clickedBtn.classList.contains('active')) {
            if (!activeFilters.archetypes.includes(filter)) activeFilters.archetypes.push(filter);
        } else {
            activeFilters.archetypes = activeFilters.archetypes.filter(f => f !== filter);
        }
        renderCards();
    }
    function getFilteredCards() {
        let cardsToShow = [];
        if (selectedCritOp) {
            cardsToShow.push(selectedCritOp);
        } else {
            cardsToShow.push(...allCards.filter(card => card.archetype === 'Crit Op'));
        }
        cardsToShow.push(...allCards.filter(card => {
            const isTacOp = card.archetype !== 'Crit Op' && card.archetype !== 'Kill Op';
            if (!isTacOp) return false;
            return activeFilters.archetypes.length === 0 || activeFilters.archetypes.includes(card.archetype);
        }));
        return cardsToShow;
    }
    function getArchetypeClass(archetype) {
        const mapping = {
            'Recon': 'recon',
            'Seek & Destroy': 'seek-destroy',
            'Security': 'security',
            'Infiltration': 'infiltration',
            'Crit Op': 'crit-op'
        };
        return mapping[archetype];
    }
    function renderCards() {
        const cardsGrid = document.getElementById('cardsGrid');
        cardsGrid.innerHTML = '';
        const cardsToShow = getFilteredCards();
        cardsToShow.forEach(card => {
            const cardElement = createCardElement(card);
            cardsGrid.appendChild(cardElement);
        });
    }
    function createCardElement(card) {
        const cardElement = document.createElement('div');
        const archetypeClass = getArchetypeClass(card.archetype);
        cardElement.className = `card ${archetypeClass}`;
        if ((selectedCritOp && selectedCritOp.name === card.name) || (selectedTacOp && selectedTacOp.name === card.name)) {
            cardElement.classList.add('selected');
        }
        cardElement.innerHTML = `<div class="card-archetype ${archetypeClass}">${card.archetype}</div><div class="card-name">${card.name}</div><div class="card-rules">${card.rules}</div>`;
        cardElement.addEventListener('click', () => selectCard(card));
        return cardElement;
    }
    function selectCard(card) {
        if (isLocked) return;
        if (card.archetype === 'Crit Op') {
            selectedCritOp = (selectedCritOp && selectedCritOp.name === card.name) ? null : card;
        } else {
            selectedTacOp = (selectedTacOp && selectedTacOp.name === card.name) ? null : card;
        }
        if (primaryOp === 'crit' && !selectedCritOp) primaryOp = null;
        if (primaryOp === 'tac' && !selectedTacOp) primaryOp = null;
        renderCards();
        updateUI();
    }
    function selectPrimary(type) {
        if (isLocked) return;
        primaryOp = (primaryOp === type) ? null : type;
        updatePrimaryButtons();
        updateUI();
    }
    function updatePrimaryButtons() {
        document.querySelectorAll('.primary-indicator').forEach(indicator => indicator.style.opacity = '0');
        document.querySelectorAll('#primaryKillBtn, #primaryCritBtn, #primaryTacBtn').forEach(btn => {
            btn.style.border = 'none';
            btn.style.boxShadow = '';
        });
        if (primaryOp) {
            const indicator = document.getElementById(`${primaryOp}PrimaryIndicator`);
            if (indicator) indicator.style.opacity = '1';
            const button = document.getElementById(`primary${primaryOp.charAt(0).toUpperCase() + primaryOp.slice(1)}Btn`);
            if (button) {
                button.style.border = '3px solid #fce83a';
                button.style.boxShadow = '0 0 10px rgba(252,232,58,0.5)';
            }
        }
    }
    function lockSelections() {
        if (!selectedCritOp || !selectedTacOp || !primaryOp) return;
        isLocked = true;
        gameStartTime = new Date();
        document.getElementById('mainContainer').classList.add('game-locked');
        document.querySelector('.top-counters').style.display = 'flex';
        document.querySelectorAll('.op-counter-box').forEach(el => el.style.display = 'flex');
        const gameTimerEl = document.getElementById('gameTimer');
        gameTimerEl.style.display = 'block';
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' };
        const lockedTime = gameStartTime.toLocaleString('en-US', options);
        gameTimerEl.textContent = `Locked In: ${lockedTime}`;
        updateUI();
    }
    function updateCounter(type, change) {
        gameCounters[type] = Math.max(0, gameCounters[type] + change);
        document.getElementById(`${type}Counter`).textContent = gameCounters[type];
    }
    function updateOpCounter(type, change) {
        opCounters[type] = Math.max(0, opCounters[type] + change);
        document.getElementById(`${type}OpCount`).textContent = opCounters[type];
        updateVPCounters();
    }
    function updateVPCounters() {
        let totalVP = 0;
        let adjustedVP = 0;
        for (const op in opCounters) {
            const points = opCounters[op];
            totalVP += points;
            if (op === primaryOp) {
                adjustedVP += Math.ceil(points * 1.5);
            } else {
                adjustedVP += points;
            }
        }
        document.getElementById('vpCounter').textContent = totalVP;
        document.getElementById('vpAdjValue').textContent = adjustedVP;
    }
    function updateUI() {
        if (isLocked) {
            const rowData = killGradeData[startingEnemyOperatives];
            let tableHTML = `<table class="kill-grade-table"><thead><tr><th>Enemy Operatives: ${startingEnemyOperatives}</th><th>Kill Grade 1</th><th>Kill Grade 2</th><th>Kill Grade 3</th><th>Kill Grade 4</th><th>Kill Grade 5</th></tr></thead><tbody><tr><td>Kills Required</td>`;
            rowData.forEach(val => {
                tableHTML += `<td>${val}</td>`;
            });
            tableHTML += `</tr></tbody></table>`;
            document.getElementById('killOpRules').innerHTML = `<p>Every enemy operative represents an elite warrior of great value to your foe.</p><strong>VICTORY POINTS:</strong><p>You start without a kill grade. As enemy operatives are incapacitated, your kill grade goes up until it reaches 5.</p><ul><li>Whenever you move to a new kill grade, you score 1VP.</li><li>At the end of the fourth turning point, if your kill grade is higher than your opponent's, you score 1VP.</li></ul>${tableHTML}<p><em>The table shows how many enemy operatives must be incapacitated to reach each kill grade for your game.</em></p>`;
        }
        const critOpSelection = document.getElementById('critOpSelection');
        const critOpStatus = document.getElementById('critOpStatus');
        const critOpRules = document.getElementById('critOpRules');
        if (selectedCritOp) {
            critOpSelection.textContent = selectedCritOp.name;
            critOpRules.innerHTML = selectedCritOp.rules;
            critOpStatus.classList.add('selected-status');
            if (isLocked) critOpStatus.classList.add('locked');
        } else {
            critOpSelection.textContent = 'Not Selected';
            critOpRules.innerHTML = '';
            critOpStatus.classList.remove('selected-status');
        }
        const tacOpSelection = document.getElementById('tacOpSelection');
        const tacOpStatus = document.getElementById('tacOpStatus');
        const tacOpRules = document.getElementById('tacOpRules');
        if (selectedTacOp) {
            tacOpSelection.textContent = selectedTacOp.name;
            tacOpRules.innerHTML = selectedTacOp.rules;
            tacOpStatus.classList.add('selected-status');
            if (isLocked) tacOpStatus.classList.add('locked');
        } else {
            tacOpSelection.textContent = 'Not Selected';
            tacOpRules.innerHTML = '';
            tacOpStatus.classList.remove('selected-status');
        }
        document.getElementById('primaryKillBtn').disabled = isLocked;
        document.getElementById('primaryCritBtn').disabled = isLocked || !selectedCritOp;
        document.getElementById('primaryTacBtn').disabled = isLocked || !selectedTacOp;
        document.getElementById('lockBtn').disabled = !(selectedCritOp && selectedTacOp && primaryOp);
        document.querySelectorAll('.primary-indicator').forEach(indicator => { indicator.style.color = '#fce83a'; });
        updateVPCounters();
    }
    document.addEventListener('DOMContentLoaded', init);
</script>

</body>
</html>
